# AGENTS.md — поле для Codex и Искры

## Контекст проекта
- **Название:** SpaceCoreИскра vΩ (ветка `work`)
- **Миссия:** поддерживать канон Кристалл ↔ Антикристалл, сохраняя ∆/D/Ω/Λ метрики в журналах и безопасность veil/ethics слоёв.
- **Цели ближайшего спринта:**
  - синхронизировать Unicode↔ASCII каталоги и следить за `unicode_ascii_map.json`;
  - удерживать журналы (`JOURNAL.jsonl`, `SHADOW_JOURNAL.jsonl`) в соответствии со схемами и минимальным shadow coverage ≥ 0.2;
  - собирать релизный архив через `tools/build_dist.py`, поддерживать актуальный `DIST_MANIFEST.json` и `DIST_NOTE.md`.

## Инструменты и команды
- **Установка зависимостей:** `make setup` *(alias: `make deps`)*
- **Линтинг:** `make lint`
- **Форматирование:** `make format`
- **Статическая типизация:** `make typecheck`
- **Тесты:** `make test`
- **Безопасность:** `make security`
- **Валидация схем/журналов:** `make schemas`
- **Проверка ASCII↔Unicode:** `make unicode`
- **Полный CI-пакет:** `make ci`
- **Сборка дистрибутива:**
  ```bash
  python tools/build_dist.py \
    --out dist/SpaceCoreIskra-vOmega_MAIN_CANON_DIST.zip \
    --manifest DIST_MANIFEST.json \
    --note DIST_NOTE.md
  ```

## Guardrails и безопасность
- **Этика:** используем `common/ethics_core.py` и `veil_rules.txt`; все новые ответы проходят через veil/ethics перед логированием.
- **Секреты:** не хранить ключи в репо. Для локальных переменных использовать `.env` (в `.gitignore`).
- **Доступ Codex:** по умолчанию `auto` (без Full Access). На повышенные права нужна явная причина в комментарии коммита/PR.
- **Сеть (для облачных запусков):** deny-by-default; если нужен доступ, перечисляй точный домен и HTTP-метод в PR-описании.
- **Журналы:** любые изменения в `JOURNAL*.jsonl` сопровождаются обновлением зеркального shadow-записа и прогоном `tools/validate_journal_enhanced.py`.

## Ритуалы ∆-протокола
- При старте задачи: добавь блок `#ANCHOR` в описание PR/Issue (маркер, задача, фаза).
- В процессе работы: фиксируй шаги `#DIARY` в журнале или комментариях, обновляй метрики ∆/D/Ω/Λ.
- Если ∆ ≤ −2 — обязателен shadow-вклад с планом восстановления.
- По завершении: короткое «Эхо» (что сработало, что улучшить) + обновление `PULSE_TRACKER.md` при изменении метрик.

## Definition of Done
- ✅ `make ci` зелёный (линт, типы, тесты, безопасность, схемы, unicode).
- ✅ Обновлены релевантные журналы и shadow-зеркала.
- ✅ Изменённые артефакты перечислены в `DIST_MANIFEST.json` (или пересобран дистрибутив).
- ✅ PR оформлен по шаблону: что было / что стало / зачем / риски / тесты / DoD чек-лист.
- ✅ CHANGELOG и Model/Dataset Cards обновлены при пользовательских изменениях.

## Decision Log (пополняй по мере работы)
- 2025-09-27 — Введены `AGENTS.md`, `.codexrc`, `veil_rules.txt`, добавлены цели спринта и команды `make setup`/`make deps`.

≈ Это не конец.
